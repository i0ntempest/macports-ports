# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           python 1.0
PortGroup           github 1.0

github.setup        pytorch vision 0.20.0 v
github.tarball_from archive
revision            0
name                py-torchvision

license             BSD
maintainers         nomaintainer
supported_archs     arm64 x86_64

description         PyTorch datasets, transforms and models specific to \
                    computer vision

long_description    The torchvision package consists of popular \
                    datasets, model architectures, and common image \
                    transformations for computer vision.

checksums           rmd160  a97033f48c2b3faa8ee0432cf18cc8903bfe8d0a \
                    sha256  b59d9896c5c957c6db0018754bbd17d079c5102b82b9be0b438553b40a7b6029 \
                    size    13149734

python.versions     39 310 311 312

if {${os.platform} eq "darwin" && ${os.major} <= 15} {
    known_fail yes
    pre-fetch {
        ui_error "$subport is not supported on OS X 10.11 and older."
        return -code error "unsupported platform"
    }
}

if {${name} ne ${subport}} {
    depends_build-append \
                    port:ninja

    depends_lib-append \
                    port:py${python.version}-Pillow \
                    port:py${python.version}-pytorch \
                    port:py${python.version}-sympy \
                    port:zmq

    compiler.cxx_standard 2014

    # Unsolvable dependency problem: sympy==1.13.1
    build.args-append \
                    --skip-dependency-check

    test.run        yes
}
